<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-01-04 Wed 10:17 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Further examples of regressions</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Daniel Ballesteros Chávez." />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style type="text/css"> tr:nth-child(odd) {background-color: #e2e2e2;}  tr:first-child {font-weight: bold}  tr:hover {background-color: #d0c6e5;}</style>
<style> pre.src { overflow: auto; }</style>
<style> .mmbox {background-color: #BFF2FF; padding: 10px 20px 10px 20px; }</style>
<style> /* Daniel Ballesteros-Chavez */
:root {
--col0: #2b2d42;		/*Top bar*/
--col1: #8d99ae;		/* Section header bg*/
--col2: #edf2f4;		/*body bg*/
--col3: #ef233c;		/*Active top bar*/
--col4: #d90429;		/*Home botton bg*/
--col5: #173f5f;			/*H2 header*/
}
body {
/*    background-image: url('./Images/bgpic.jpg'); */
background-size: cover;
background-attachment: fixed;
font-family: Helvetica;
/* background-position: left top; */
/* background-repeat: no-repeat; */
background: var(--col2);
margin: 20px auto; /* "auto" for centering */
max-width: 768px;
/* max-width: 800px; */
/* font-family: monospace; */
}
h1 {
display: block;
font-size: 1.5em;
/* margin-top: 0.67em; */
/* margin-bottom: 0.67em; */
margin-left: 0;
margin-right: 0;
font-weight: bold;
color: var(--col0);
padding: 5px 20px;
/*    background-color:#092B39;*/
/*text-align: center; */
/*text-shadow: 3px 2px gray;*/
}
h2 {
display: block;
font-size: 1em;
margin-top: 0.67em;
margin-bottom: 0.67em;
margin-left: 0;
margin-right: 0;
font-weight: bold;
color: var(--col0);
background-color: var(--col1);
border-radius: 10px 10px;
padding: 10px 20px;
/*    background-color:#092B39;*/
}
div.outline-2 {
background-color: var(--col2);
/* border:3px solid #f2f6f9; */
color: var(--col0);
}
div.outline-2 h2 {
color: var(--col5);
font-size: 20px; /* arial, sans-serif; */
/* font-family: 'Fredoka One', cursive; */
}
div.outline-text-2 {
}
div.outline-text-2 p {
text-align: justify;
}
</style>
<style>code {background-color: #ccc}</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Further examples of regressions</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org37140c5">The explicit calculation of the AIC</a></li>
<li><a href="#org39e87ce">Forcing the intercept</a></li>
<li><a href="#orgf74e41c">Polynomial Regressions</a></li>
<li><a href="#orgd069406">Using ANOVA to choose the best fitted model.</a></li>
<li><a href="#orgc2e1a5f">Logarithmic Regressions</a></li>
<li><a href="#orgd4e40c9">Power model</a></li>
<li><a href="#org3a70214">Multilinear Example</a></li>
</ul>
</div>
</div>


<div id="outline-container-org37140c5" class="outline-2">
<h2 id="org37140c5">The explicit calculation of the AIC</h2>
<div class="outline-text-2" id="text-org37140c5">
<p>
The Akaike information criterion (AIC) is an estimator of prediction
error of statistical models for a given data set.
</p>

<p>
AIC estimates the relative amount of information lost by a given
model: the less information a model loses, the higher the quality of
that model.
</p>

<p>
Given 2 models with \(AIC_1\) and \(AIC_2\), define \(AIC_{min}\) to be the minimum between
\(AIC_1\) and \(AIC_2\). Then the quantity:
</p>
\begin{equation}
\exp\left( \frac{AIC_{min} - AIC_{j}}{2}\right),
\end{equation}

<p>
can be interpreted as being proportional to the probability that the
 model "j" minimizes the (estimated) information loss.
</p>

<div class="org-src-container">
<pre class="src src-R">df <span style="color: #0288D1;">&lt;-</span> data.frame(
<span style="color: #6C3082;">"Year"</span> = c(
2000, 2001, 2002, 2003, 2004, 2005,
2006, 2007, 2008, 2009, 2010, 2011,
2012, 2013, 2014, 2015, 2016, 2017,
2018, 2019, 2020),
<span style="color: #6C3082;">"Expenditure"</span> = c(
125, 127, 118, 119, 135, 146,
155, 175, 202, 238, 270, 303,
372, 375, 420, 470, 467, 536,
668, 789, 845),
<span style="color: #6C3082;">"PatentsApp"</span> = c(
2404, 2202, 2313, 2268, 2381, 2028,
2157, 2392, 2488, 2883, 3203, 3880,
4415, 4237, 3939, 4676, 4261, 3942,
4207, 3887, 4010))

myfit  <span style="color: #0288D1;">&lt;-</span> lm(PatentsApp ~ Expenditure, data= df)

<span style="color: #795548;">## </span><span style="color: #795548;">note that we can write</span>


mu <span style="color: #0288D1;">&lt;-</span> myfit$fitted.values
NN <span style="color: #0288D1;">&lt;-</span> length(df$PatentsApp)
rss <span style="color: #0288D1;">&lt;-</span> sum((myfit$model$PatentsApp - mu)^2)  <span style="color: #795548;">## </span><span style="color: #795548;">RSS  residue sums of squares</span>
ss2 <span style="color: #0288D1;">&lt;-</span> rss/(NN) <span style="color: #795548;">## </span><span style="color: #795548;">Here we use the Population variance definition.</span>
ssdd <span style="color: #0288D1;">&lt;-</span> sqrt(ss2)

my.log.like <span style="color: #0288D1;">&lt;-</span> -NN/2 * log(2*pi) - NN*log(ssdd) - rss/(2*ss2)

p <span style="color: #0288D1;">&lt;-</span> 2 <span style="color: #795548;">## </span>

my.aic <span style="color: #0288D1;">&lt;-</span> -2*my.log.like + 2*(p+1)

summary(myfit)
print(c( AIC(myfit), my.aic))
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">331.409410702845</td>
</tr>

<tr>
<td class="org-right">331.409410702845</td>
</tr>
</tbody>
</table>
</div>
</div>




<div id="outline-container-org39e87ce" class="outline-2">
<h2 id="org39e87ce">Forcing the intercept</h2>
<div class="outline-text-2" id="text-org39e87ce">
<p>
Hooke's law is a law of physics that states that the force \(F\) needed
to extend or compress a spring by some distance \(x\) scales linearly
with respect to that distance
</p>

\begin{equation}
F = kx, 
\end{equation}

<p>
where k is a constant
factor characteristic of the spring (i.e., its stiffness), and \(x\) is
small compared to the total possible deformation of the spring.
</p>

<p>
An experiment was draw and the following data was observed:
</p>

<div class="org-src-container">
<pre class="src src-R">
<span style="color: #388E3C;">my_plotLM</span>  <span style="color: #0288D1;">&lt;-</span> <span style="color: #bf360c;">function</span>(x, ... ){
    <span style="color: #bf360c;">if</span>(!class(x)<span style="color: #0288D1;">%in%</span><span style="color: #6C3082;">"lm"</span>) <span style="color: #bf360c;">stop</span>(<span style="color: #6C3082;">"We expect a linear model (lm) object"</span>)
plot(x$model[,2], x$model[,1], 
pch= 19, col=<span style="color: #6C3082;">"darkblue"</span>, ...,
main=paste(<span style="color: #6C3082;">"Points with fitted line"</span>, 
<span style="color: #6C3082;">"\n Y = ("</span>, round(x$coefficients[2],2), 
<span style="color: #6C3082;">") * X + "</span>, round(x$coefficients[1],2),
<span style="color: #6C3082;">"\n r^2 = "</span>, round(summary(x)$r.squared,3)))
<span style="color: #795548;">#</span><span style="color: #795548;">xlab ="zl per capita", ylab = "Patents applications")</span>
ifelse(length(x$coefficients = 1,
abline(0,x$coefficients, col=<span style="color: #6C3082;">"lightblue"</span>, lwd=3)
abline(x$coefficients, col=<span style="color: #6C3082;">"lightblue"</span>, lwd=3))
    }

<span style="color: #388E3C;">my_plotLM2</span>  <span style="color: #0288D1;">&lt;-</span> <span style="color: #bf360c;">function</span>(x, ... ){
    <span style="color: #bf360c;">if</span>(!class(x)<span style="color: #0288D1;">%in%</span><span style="color: #6C3082;">"lm"</span>) <span style="color: #bf360c;">stop</span>(<span style="color: #6C3082;">"We expect a linear model (lm) object"</span>)
plot(x$model[,2], x$model[,1], 
pch= 19, col=<span style="color: #6C3082;">"darkblue"</span>, ...,
main=paste(<span style="color: #6C3082;">"Points with fitted line"</span>, 
<span style="color: #6C3082;">"\n Y = ("</span>, round(x$coefficients[2],2), 
<span style="color: #6C3082;">") * X + "</span>, round(x$coefficients[1],2),
<span style="color: #6C3082;">"\n r^2 = "</span>, round(summary(x)$r.squared,3)))
<span style="color: #795548;">#</span><span style="color: #795548;">xlab ="zl per capita", ylab = "Patents applications")</span>
    matlines(x$model[,2],predict(x,int=<span style="color: #6C3082;">"c"</span>),
             col=c(<span style="color: #6C3082;">"light blue"</span>, <span style="color: #6C3082;">"grey"</span>, <span style="color: #6C3082;">"grey"</span>),
             lwd=c(2,2,2),
             lty=c(1,2,2))
    }

df  <span style="color: #0288D1;">&lt;-</span> data.frame(
    <span style="color: #6C3082;">"weight.gr"</span> = c(20,40,50,70,100,300,350,400,450,500),
    <span style="color: #6C3082;">"deformation"</span>= c(0.3 ,1 ,1.4 ,2.4 ,3.7 ,12.1 ,15.4 ,16.6 ,18.7 ,21))


myfit  <span style="color: #0288D1;">&lt;-</span> lm(deformation ~ weight.gr , data =df)
my_plotLM(myfit)

myfit2  <span style="color: #0288D1;">&lt;-</span> lm(deformation  ~ weight.gr + 0  , data =df) <span style="color: #795548;">## </span><span style="color: #795548;">forcing the intercept to be 0</span>
<span style="color: #795548;">## </span><span style="color: #795548;">myfit2.2  &lt;- lm(deformation ~ weight.gr -1  , data =df) ## forcing the intercept to be 0 different syntax that does the same (force intercept to be 0)</span>




my_plotLM2(myfit2)

<span style="color: #795548;">###  </span>
<span style="color: #795548;">###  </span><span style="color: #795548;">R^2 how it is computed when forcing the intercept to 0? </span>
<span style="color: #795548;">###  </span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgf74e41c" class="outline-2">
<h2 id="orgf74e41c">Polynomial Regressions</h2>
<div class="outline-text-2" id="text-orgf74e41c">
<p>
The relationship between \(y\) and \(x\) often turns out not to be a straight
line.  how do we assess the significance of departures from linearity?
One of the simplest ways is to use polynomial regression.
</p>

<p>
We have just one continuous explanatory variable, \(x\), but we can fit
higher powers of \(x\), such as \(x^2\) and \(x^3\) , to the model in
addition to \(x\) to explain <b>curvature</b> in the relationship between y
and \(x\). It is useful to experiment with the kinds of curves that can be
generated with very simple models.
</p>



<div class="org-src-container">
<pre class="src src-R">
<span style="color: #795548;"># </span><span style="color: #795548;">source("my_Rtools.R")</span>

df <span style="color: #0288D1;">&lt;-</span> data.frame(
<span style="color: #6C3082;">"Year"</span> = c(
2000, 2001, 2002, 2003, 2004, 2005,
2006, 2007, 2008, 2009, 2010, 2011,
2012, 2013, 2014, 2015, 2016, 2017,
2018, 2019, 2020),
<span style="color: #6C3082;">"Expenditure"</span> = c(
125, 127, 118, 119, 135, 146,
155, 175, 202, 238, 270, 303,
372, 375, 420, 470, 467, 536,
668, 789, 845),
<span style="color: #6C3082;">"PatentsApp"</span> = c(
2404, 2202, 2313, 2268, 2381, 2028,
2157, 2392, 2488, 2883, 3203, 3880,
4415, 4237, 3939, 4676, 4261, 3942,
4207, 3887, 4010))


myfit1 <span style="color: #0288D1;">&lt;-</span> lm(PatentsApp ~ Expenditure, data= df)
myfit2 <span style="color: #0288D1;">&lt;-</span> lm(PatentsApp ~ Expenditure + I(Expenditure^2), data = df)
myfit3 <span style="color: #0288D1;">&lt;-</span> lm(PatentsApp ~ Expenditure + I(Expenditure^2) + I(Expenditure^3), data = df)
</pre>
</div>
</div>
</div>


<div id="outline-container-orgd069406" class="outline-2">
<h2 id="orgd069406">Using ANOVA to choose the best fitted model.</h2>
<div class="outline-text-2" id="text-orgd069406">
<p>
The ANOVA analysis performs an \(F\) test that is similar to the \(F\) test
for a linear regression. The difference is that this test is between
two models, whereas the regression \(F\) test is between using the
regression model and using no model.
</p>

<p>
We can use anova to compare them, and the result is a p-value which we
can compare. A small p-value indicates that the models are
significantly different.
</p>

<div class="org-src-container">
<pre class="src src-R">
anova(myfit1,myfit2)
anova(myfit2,myfit3)
</pre>
</div>
</div>
</div>


<div id="outline-container-orgc2e1a5f" class="outline-2">
<h2 id="orgc2e1a5f">Logarithmic Regressions</h2>
<div class="outline-text-2" id="text-orgc2e1a5f">
<p>
In this section we are insterested in models of the type
</p>

\begin{equation}
y = ae^{bx}
\end{equation}


<p>
As an example, these type of model appears in the decay of
organic material in soil, and our mechanistic model is based on the assumption that the fraction of dry matter
lost per year is a constant.
</p>

\begin{equation}
y = y_0 e^{-bt}
\end{equation}	

<p>
Here \(y_0\) is the initial dry mass (at time \(t = 0\)) and \(b\) is the decay rate (the parameter we want to estimate by
linear regression). Taking logs of both sides, we get
</p>

\begin{equation}
\ln(y) = \ln(y_0) - bt.
\end{equation}	

<p>
consider the following data:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">time</th>
<th scope="col" class="org-right">amount</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">125</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">100.2488583</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">70</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">83.47079531</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">100</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">65.90786956</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-right">66.53371457</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-right">53.58808673</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-right">61.33235104</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">43.92743547</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">40.29544843</td>
</tr>

<tr>
<td class="org-right">11</td>
<td class="org-right">44.71345876</td>
</tr>

<tr>
<td class="org-right">12</td>
<td class="org-right">32.53314287</td>
</tr>

<tr>
<td class="org-right">13</td>
<td class="org-right">36.64033626</td>
</tr>

<tr>
<td class="org-right">14</td>
<td class="org-right">40.15471123</td>
</tr>

<tr>
<td class="org-right">15</td>
<td class="org-right">23.08029549</td>
</tr>

<tr>
<td class="org-right">16</td>
<td class="org-right">39.86792844</td>
</tr>

<tr>
<td class="org-right">17</td>
<td class="org-right">22.84978589</td>
</tr>

<tr>
<td class="org-right">18</td>
<td class="org-right">35.01464535</td>
</tr>

<tr>
<td class="org-right">19</td>
<td class="org-right">17.97726709</td>
</tr>

<tr>
<td class="org-right">20</td>
<td class="org-right">21.1591801</td>
</tr>

<tr>
<td class="org-right">21</td>
<td class="org-right">27.99827279</td>
</tr>

<tr>
<td class="org-right">22</td>
<td class="org-right">21.88573499</td>
</tr>

<tr>
<td class="org-right">23</td>
<td class="org-right">14.27396172</td>
</tr>

<tr>
<td class="org-right">24</td>
<td class="org-right">13.66596918</td>
</tr>

<tr>
<td class="org-right">25</td>
<td class="org-right">11.81643542</td>
</tr>

<tr>
<td class="org-right">26</td>
<td class="org-right">25.18901636</td>
</tr>

<tr>
<td class="org-right">27</td>
<td class="org-right">8.195643809</td>
</tr>

<tr>
<td class="org-right">28</td>
<td class="org-right">17.19133663</td>
</tr>

<tr>
<td class="org-right">29</td>
<td class="org-right">24.28335424</td>
</tr>

<tr>
<td class="org-right">30</td>
<td class="org-right">17.72277625</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgd4e40c9" class="outline-2">
<h2 id="orgd4e40c9">Power model</h2>
<div class="outline-text-2" id="text-orgd4e40c9">
<p>
Another related model is given by
</p>


\begin{equation}
y = ax^b,
\end{equation}

<p>
and when taking the logarithms we obtain
</p>

\begin{equation}
\ln(y) = \ln(a) + b\ln(x).
\end{equation}

<p>
Try to fit a linear model and exponential model to the following data set
</p>

<div class="org-src-container">
<pre class="src src-R">area <span style="color: #0288D1;">&lt;-</span>c(2.32155        , 2.525543, 2.627449, 2.195558, 1.088055, 2.044432, 1.79707     , 2.302335, 2.187373, 1.506705, 1.828855, 2.336525, 1.468181, 1.048413, 1.469381, 2.55183       , 1.618446, 1.543634, 1.707257, 1.854963, 2.59554       , 2.247533, 1.823993, 1.723572, 2.13321 , 1.586938, 1.073923, 1.193971, 1.932372, 1.089122)
response <span style="color: #0288D1;">&lt;-</span> c(2.367588, 2.881607, 2.641165, 2.592812, 2.15938   , 2.365786, 2.548956, 2.741471, 2.468152, 2.580795, 2.53684     , 2.41033       , 2.142693, 2.07412     , 2.517654, 2.833151, 2.377668, 2.409813, 2.227562, 2.49544     , 2.932836, 2.800229, 2.508883, 2.387154, 2.385757, 2.483149, 2.095175, 2.134681, 2.360977, 2.419167)

myfit1 <span style="color: #0288D1;">&lt;-</span> lm(response ~ area)
myfit2 <span style="color: #0288D1;">&lt;-</span> lm(log(response) ~ log(area))

plot(area,response, pch=19, col=<span style="color: #6C3082;">"blue"</span>, xlim=c(0,5),ylim =c(0,5))
xx <span style="color: #0288D1;">&lt;-</span> exp(myfit2$model[,2])
xx <span style="color: #0288D1;">&lt;-</span>xx[order(xx)]
abline(myfit1$coefficient,col=<span style="color: #6C3082;">"red"</span>)
lines(xx, exp(myfit2$coefficients[1])*(xx)^(myfit2$coefficients[2]), col=<span style="color: #6C3082;">"green"</span>)



plot(area,response, pch=19, col=<span style="color: #6C3082;">"blue"</span>, xlim=c(0,5),ylim =c(0,5))
abline(myfit1$coefficient,col=<span style="color: #6C3082;">"red"</span>)
<span style="color: #795548;"># </span><span style="color: #795548;">xx &lt;- exp(myfit2$model[,2])</span>
<span style="color: #795548;"># </span><span style="color: #795548;">xx &lt;-xx[order(xx)]</span>
xx <span style="color: #0288D1;">&lt;-</span> seq(0,5, by=0.1)
lines(xx, exp(myfit2$coefficients[1])*(xx)^(myfit2$coefficients[2]), col=<span style="color: #6C3082;">"green"</span>)
</pre>
</div>


<p>
The moral: you need to extremely careful when using regression models for prediction. If you
know that response must be zero when area is zero (the graph has to pass through the origin) then
obviously the power function is likely to be better for extrapolation to the left of the data. But if we have no
information on non-linearity other than that contained within the data, then parsimony suggests that errors
will be smaller using the simpler, linear model for prediction
</p>
</div>
</div>



<div id="outline-container-org3a70214" class="outline-2">
<h2 id="org3a70214">Multilinear Example</h2>
<div class="outline-text-2" id="text-org3a70214">
<p>
The homeprice dataset contains information about homes that sold in a town of New Jersey
in the year 2001. We wish to develop some rules of thumb in order to help us figure out what are
appropriate prices for homes. First, we need to explore the data a little bit.
</p>


<p>
We’ll begin with the regression on bedrooms and neighbourhood.
</p>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #0288D1;">library</span>(<span style="color: #6C3082;">"UseR"</span>)
summary(lm(sale ~ bedrooms + nbd))
</pre>
</div>


<p>
Next, we know that home buyers covet bathrooms. Hence, they should add value to a house. How
much?
</p>


<p>
This seems a little high, as the construction cost of a
new bathroom is less than this. Could it possibly be $5 thousand?
</p>

<p>
For the homeprice dataset, what does a half bathroom do for the sale price?
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Daniel Ballesteros Chávez.</p>
<p class="date">Created: 2023-01-04 Wed 10:17</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
